#### 2.3 实现Around通知

在实现动态代理之后，就可以实现环绕通知（Around Advice），它在方法调用前后执行自定义逻辑，前置通知和后置通知都可以基于环绕通知实现。

假设在我们简化版的Spring框架中，Around的使用方式如下（当然和Spring-AOP有区别）：

```java
@Component
@Around("aroundInvocationHandler")
public class OriginBean {

    @Value("${customer.name}")
    public String name;

    @Polite
    public String hello() {
        return "Hello, " + name + ".";
    }

    public String morning() {
        return "Morning, " + name + ".";
    }
}
```

此处`@Around`注解的值`aroundInvocationHandler`指出应该按什么名字查找拦截器：

```java
@Component
public class AroundInvocationHandler implements InvocationHandler {
    @Override
    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {
        // 拦截标记了@Polite的方法返回值:
        if (method.getAnnotation(Polite.class) != null) {
            String ret = (String) method.invoke(proxy, args);
            if (ret.endsWith(".")) {
                ret = ret.substring(0, ret.length() - 1) + "!";
            }
            return ret;
        }
        return method.invoke(proxy, args);
    }
}
```

为了将AOP代理增强的Bean注入到Spring容器中，以Around通知为例，我们还需要实现一个`AroundProxyBeanPostProcessor`：

```java
